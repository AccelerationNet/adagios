{% extends "base_misc.html" %}

{% block title %}Audit Log{% endblock %}
{% block smallheader %}audit{% endblock %}
{% block largeheader %}log{% endblock %}
{% block nav1 %}misc{% endblock %}

{% block content %}

    <div id='chart_div'></div>

    <h1>Object Count</h1>
    <div id="chartdiv" style="height:300px;width:98%; "></div>


{% endblock %}

{% block footer %}
    {{ block.super }}
    <script type='text/javascript'>
        var datarows = [["mike","",""]];
    </script>
    <script type='text/javascript' src='https://www.google.com/jsapi'></script>
    <script type='text/javascript'>

    var datarows = $.parseJSON(
            $.ajax(
                    {
                        url: "{% url rest/pynag %}json/contactgroup_hierarchy?limit=100",
                        async: false,
                        dataType: 'json'
                    }
            ).responseText
    );

        google.load('visualization', '1', {packages:['orgchart']});
        google.setOnLoadCallback(drawChart);
        function drawChart() {
            var data = new google.visualization.DataTable();1
            data.addColumn('string', 'Name');
            data.addColumn('string', 'Manager');
            data.addColumn('string', 'ToolTip');
            data.addRows( datarows );
            var chart = new google.visualization.OrgChart(document.getElementById('chart_div'));
            chart.draw(data, {allowHtml:true, allowCollapse:true});
        }
    </script>


    <script type="text/javascript" src="{% url media path="/jqplot/" %}jquery.jqplot.min.js"></script>
    <script type="text/javascript" src="{% url media path="/jqplot/" %}plugins/jqplot.barRenderer.min.js"></script>
    <script type="text/javascript" src="{% url media path="/jqplot/" %}plugins/jqplot.categoryAxisRenderer.min.js"></script>
    <script type="text/javascript" src="{% url media path="/jqplot/" %}plugins/jqplot.pointLabels.min.js"></script>
    <script type="text/javascript" src="{% url media path="/jqplot/" %}plugins/jqplot.canvasAxisTickRenderer.min.js"></script>
    <script type="text/javascript" src="{% url media path="/jqplot/" %}plugins/jqplot.canvasTextRenderer.min.js"></script>
    <!-- <script type="text/javascript" src="{% url media path="/jqplot/" %}"></script>
    <script type="text/javascript" src="{% url media path="/jqplot/" %}"></script> -->



        <script>
        $(document).ready(function() {
            var object_types = [];
            var graph_data_active = [];
            var graph_data_inactive = [];
            {% for i in object_types %}
                object_types.push( "{{ i.nameÂ }}" );
                graph_data_active.push({{ i.active }});
                graph_data_inactive.push({{ i.inactive }});
            {% endfor %}

            var plot1 = $.jqplot('chartdiv', [graph_data_active, graph_data_inactive], {
               // The "seriesDefaults" option is an options object that will
               // be applied to all series in the chart.
               seriesDefaults:{
                   renderer:$.jqplot.BarRenderer,
                   rendererOptions: {fillToZero: true},
                   shadow: true
               },
               animate: true,
                stackSeries: true,
               // Custom labels for the series are specified with the "label"
               // option on the series option.  Here a series option object
               // is specified for each series.
               series:[
                   {label:'Active'},
                   {label:'Inactive'},
               ],

               // Show the legend and put it outside the grid, but inside the
               // plot container, shrinking the grid to accomodate the legend.
               // A value of "outside" would not shrink the grid and allow
               // the legend to overflow the container.
               legend: {
                   show: true,
                   placement: 'outsideGrid'
               },
               axesDefaults: {
                    tickRenderer: $.jqplot.CanvasAxisTickRenderer ,
                    tickOptions: {
                      angle: -30,
                      fontSize: '10pt'
                    }
               },
               axes: {
                   // Use a category axis on the x axis and use our custom ticks.
                   xaxis: {
                       renderer: $.jqplot.CategoryAxisRenderer,
                       ticks: object_types
                   },
                   // Pad the y axis just a little so bars can get close to, but
                   // not touch, the grid boundaries.  1.2 is the default padding.
                   yaxis: {


                   }
               }

            });
        });
        </script>


{% endblock %}