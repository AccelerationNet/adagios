{% extends "base1.html" %}

{% load adagiostags %}
{% block titlebar %} {% endblock %}
{% block maincontent %}
    <table class="table table-condensed" style="white-space: nowrap;">

    {% if network_problems %}
        <tr>
        <th colspan=5>
            <h3>Network outage:</h3>
        </th>
        </tr>
        <!--
        <tr>
            <th style="width: 20px; max-width: 20px;"></th>
            <th>Host Name</th>
            <th></th>
            <th>Description</th>

        </tr>
        -->
        {% for i in network_problems %}
            <tr style="color: black;">
                <td><div class="circle circle-spin state_{{ i.state }}"></div></td>
                <td>{{ i.name }}</td>
                <td></td>
                <td>
                    {{ i.plugin_output }}
                </td>
                <td>
                    {{ i.last_state_change|timestamp|timesince }}
                </td>

            </tr>
        {% endfor %}

    {% endif %}
    {% if host_problems %}
        <tr>
        <th colspan=5>
            <h3>Unhandled Host Problems:</h3>
        </th>
        </tr>
        <!--
        <tr>
            <th style="width: 20px; max-width: 20px;"></th>
            <th>Host Name</th>
            <th></th>
            <th>Description</th>
        </tr>
        -->
        {% for i in host_problems %}
            <tr style="color: black;">
                <td><div class="circle circle-spin state_{{ i.state }}"></div></td>
                <td>{{ i.name }}</td>
                <td></td>
                <td>
                    {{ i.plugin_output }}
                </td>
                <td>
                    {{ i.last_state_change|timestamp|timesince }}
                </td>
            </tr>
        {% endfor %}
    {% endif %}

    {% if service_problems %}
        <tr>
        <td colspan=5>
            <h3>Unhandled Service problems:</h3>
        </td>
        </tr>
        <!--
        <tr>
            <th style="width: 20px; max-width: 20px;"></th>
            <th>Host Name</th>
            <th>Service</th>
            <th>Description</th>
        </tr>
        -->
        {% for i in service_problems %}
            <tr>
                <td><div class="circle  state_{{ i.state }}{{ i.unhandled }}"></div></td>
                <td>{{ i.host_name }}</td>
                <td>
                    {{ i.description }}
                </td>
                <td>
                    {{ i.plugin_output }}
                </td>
                <td>
                    {{ i.last_state_change|timestamp|timesince }}
                </td>
            </tr>
        {% endfor %}
    {% endif %}
</table>

{% if log %}
    <h3>Last {{ log|length }} alerts:</h3>
    <table style="font-size: 80%;" class="table table-condensed" table-striped>
        {% for line in log %}
                <tr>
                    <td width=20px style="white-space: nowrap;">{{ line.time|timestamp|date:'Y-m-d H:i' }} </td>
                    <td width=20px><div>{{ line.host_name }}</div></td>
                    <td width=200px><div>{{ line.service_description }}</div></td>
                    <td width="20px"><div class="circle state_{{ line.state }}"></div></td>
                    <td>
                        <div>{{ line.plugin_output }}</div></td>
                </tr>
        {% endfor %}
    </table>
{% endif %}
{% endblock %}