{% extends "base_status.html" %}

{% block title %}Status Log{% endblock %}
{% block smallheader %}{% endblock %}
{% block largeheader %}Status Log{% endblock %}

{% block nav1 %}{{ block.super }}{% endblock %}
{% load adagiostags %}

{% block content %}
    <form method=GET action="#">
    Host Name: <input name="host_name" value="{{ request.GET.host_name }}"/>
    Service Description: <input name="service_description" value="{{ request.GET.service_description }}"/>
    Class: <input name="class" value="{{ request.GET.class }}"/>
    <button type="submit" name="submit" >Submit</button>
    </form>
    {% if request.GET.class == "1" %}
    Last {{ log|length }} log entries:
        <table style="font-size: 80%;" class="table well table-condensed" table-striped>
            <thead>
            <th>Time</th>
            <th>Host</th>
            <th>Service</th>
            <th></th>
            <th>Message</th>
            </thead>
            {% for line in log %}
                {% ifchanged line.time|timestamp|date:"Y-m-d" %}
                    <!-- <tr><td colspan=4></td></tr> -->
                {% endifchanged %}
                <tr>
                    <td style="white-space: nowrap;">{{ line.time|timestamp|date:'Y-m-d H:i' }} </td>
                    <td><a href="?class={{ request.GET.class }}&host_name={{ line.host_name }}">{{ line.host_name }}</a></td>
                    <td><a href="?class={{ request.GET.class }}&host_name={{ line.host_name }}&service_description={{ line.service_description }}">{{ line.service_description }}</a></td>
                    <td><div class="circle state_{{ line.state }}"></div></td>
                    <td>
                        <div>{{ line.plugin_output }}</div></td>
                </tr>
            {% endfor %}
        </table>
        </div>
    {% endif %}


{% endblock %}



{% block footer %} {{ block.super }} {% endblock %}