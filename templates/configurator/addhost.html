
{% extends "configurator/base.html" %}

{% block title %}Adagios - Add Host{% endblock %}


{% block javascript %}
		$(document).ready(function() {
				var progress = 0;
			    $("#progressbar").progressbar({ value: 0 });
				function updateProgress() {
					if (progress < 100) {
						progress = progress + 1;
			    	$("#progressbar").progressbar({ value: progress });
						setTimeout(updateProgress, 100);
					}
				}
				updateProgress();
			$('#hostname').focus();
			$.getJSON("/adagios/api/get_templates.json", function(json) {
				deferred = [];
				$.each(json.templates, function(key, object) {
					if (object.parents.length == 0) {
						
						$('#os').append($('<option></option>').val(key).text(object.name));
						$('#subtemplates').append("<fieldset class='subtemplate' id='subtemplate_" + key + "'><legend>Templates</legend></fieldset>");
					} else {
						deferred.push(key);
					}
						      	/* <p><input type="checkbox" class="left" /> <label>Microsoft Exchange</p>
						      	<p style="clear: both"><input type="checkbox" class="left" /> <label>Microsoft SQL Server</p>
					<fieldset class="subtemplates" id="subtemplates">
						    <legend>Templates</legend>
						  </fieldset> */
				});
				$.each(deferred, function(key, template) {
					$.each(json.templates[template].parents, function(i, parent) {
						$('#subtemplate_' + parent).append('<p style="clear: both"><input type="checkbox" name="' + template + ' class="left" /> <label>' + json.templates[template].name + '</p>');
					});
				});
			});
		});

{% endblock %}

{% block head %}


{% endblock %}


{% block content %}



<form action="#" method="POST">

	<!-- wrapper for scrollable items -->
	<div id="tabs">

		<ul>
			<li><a href="#host">Hostinfo</a></li>
			<li><a href="#templates">Templates</a></li>
		</ul>
		<div id="host">
			  <fieldset id="hostinfo">
				<legend>Host Information</legend>

			  		
						<div id="warn_hostname"></div>
						<p>
							<label for="hostname">Hostname <em>*</em></label>
							<input id="hostname" type="text" name="hostname" />
						</p>
						<p>						<p>
							<label for="hostname">Allow Scanning?</label>
							<input id="scan" type="checkbox" name="scan" CHECKED />
							<span id="warn_scan"></span>
						</p>
						
						<p>
							<label for="description">Description</label>
							<input id="description" type="text" name="description" />
							<span id="warn_description"></span>
						</p>
						<p>
							<label for="ipaddress">IP Address <em>*</em></label>
							<input id="ipaddress" type="text" name="ipaddress" />
							<span id="warn_hostname"></span>
						</p>
			  		
				</fieldset>
			
		</div>	
		<div id="templates">
						<div id="accordion" class="accordion">
			<div>
				<h4><a href="#">Suggested Templates</a></h4>
				<div>Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet.</div>
			</div>
			<div>
				<h4><a href="#">Popular Templates</a></h4>
				<div>Phasellus mattis tincidunt nibh.</div>
			</div>
			<div>
				<h4><a href="#">All Templates</a></h4>
				<div>Nam dui erat, auctor a, dignissim quis.</div>
			</div>

						  
						</div>
		</div>


		<div class="scan ui-tabs">
			<p>Scan progress
			<div style="height: 12px" id="progressbar"></div>
			</p>
		</div>
	</div>

</form>		

<!-- activate tabs with JavaScript -->
<script>
// wait until document is fully scriptable
$('#accordion').accordion({ header: "h4" });
$('#tabs').tabs();
$('#tabs').tabs('add', '#cramp', "Ble");
$(function() {

});
</script>

<script type="text/javascript">
				$('#hostname').keypress(function() {
					if ($('#warn_hostname').html() != "") {
						$('#warn_hostname').html("");
					}
				});
				
				
				$('#os').change(function() {
					$('.subtemplate').hide();					
					$('#subtemplate_' + $('#os').val()).show();
				});
				
				$('#hostname').blur(function(e) {
					if ($(this).val() == "") {
						return false;
					}
					$.getJSON("/adagios/api/host/" + $(this).val() + ".json", function(json) {
						if (json.host.host_name != "null") {		
							$('#warn_hostname').html('<img src="/static/attention.png" title="Hostname already exists" />');
							$("#warn_hostname img[title]").tooltip({
							
	// place tooltip on the right edge
	position: "center right",

	// a little tweaking of the position
	offset: [-2, 10],

	// use the built-in fadeIn/fadeOut effect
	effect: "fade",

	// custom opacity setting
	opacity: 0.7 });
							$('#hostname').select();
							e.stopImmediatePropagation();
						}
					});
					$.getJSON("/adagios/api/gethostbyname/" + $('#hostname').val(), function(json) {
			    					$('#ipaddress').val(json.host);
			 		});
				});

		</script>
{% endblock %}
